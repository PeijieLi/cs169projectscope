%table.table
  %tbody
    %tr{id: "sample_#{sample.id}", class: "sample_row_#{sample.id} comment_thread_head"}
      %td{style: 'text-align: center'}
        %div.chart_place{:id => "project-#{@project.id}-ondate-#{sample.metric_name}-#{sample.days_ago}"}
    - sample.comments.where(ctype: 'general_comment').each do |cmnt|
      %tr{id: "comment_#{cmnt.id}", class: "sample_row_#{sample.id}"}
        %td
          = render partial: 'comment_view', :locals => {:comment => cmnt}
    - if can? :create, Comment and can? :create_comment, @project
      %tr{id: "buttons_#{num}", class: "sample_row_#{sample.id}"}
        %td
          %a.function_link{onclick: "read_sample(#{sample.id})", id: "read_button_#{sample.id}"}
            Mark All Read
          %a.function_link{onclick: "reveal_comment_form(#{sample.id})", id: "reply_button_#{sample.id}"}
            Add Reply
      %tr{id: "comment_form_#{sample.id}", class: "sample_row_#{sample.id}", style:"display:none"}
        %td
          = render partial: 'comment_form', :locals => { :identity => "project-#{@project.id}-ondate-#{sample.metric_name}-#{sample.days_ago}", 
                                                          :num => "#{num}", 
                                                          :ms_id => sample.id, 
                                                          :button_name => "Reply"}